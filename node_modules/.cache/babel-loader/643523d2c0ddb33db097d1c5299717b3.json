{"ast":null,"code":"var _jsxFileName = \"/Users/rushipat/Documents/Data/Programs/videochatapp/src/App.js\";\nimport React, { Component } from \"react\";\nimport \"./App.css\";\nimport VideoChatContainer from \"./VideoChatContainer\";\nimport firebase from \"firebase/app\";\nimport config from \"./config\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = async () => {\n      //component mounts, only after the first render on the client side\n      console.log(\"COMPONENT DID MOUNT\");\n      firebase.initializeApp(config); //this.writeUserData();\n\n      await this.getUserData();\n    };\n\n    this.writeUserData = () => {\n      //save the state\n      console.log(\"SAVING DATA\");\n      firebase.database().ref(\"/rooms\").set(this.state.rooms);\n      firebase.database().ref(\"/roomusers\").set(this.state.room_users);\n    };\n\n    this.errData = err => {\n      console.log(\"GOT AN ERROR\");\n      console.log(err);\n    };\n\n    this.nameNewRoom = () => {\n      console.log(\"NAMING NEW ROOM\");\n      this.setState({\n        active: 0\n      });\n    };\n\n    this.enterRoom = room => {\n      console.log(\"ENTERING ROOM\" + room.id);\n      this.setState({\n        active: room.id + 1\n      });\n    };\n\n    this.authenticateUser = () => {\n      console.log(\"AUTHENTICATING USER\");\n      this.setState({\n        active: -1\n      });\n    };\n\n    this.constructRoom = () => {\n      console.log(\"CREATING ROOM\");\n      const temp_rooms = this.state.rooms;\n      temp_rooms.push({\n        id: temp_rooms.length\n      });\n      this.setState({\n        rooms: temp_rooms\n      }); //this.setState({ active: temp_rooms.length });\n\n      this.enterRoom(temp_rooms[temp_rooms.length]);\n    };\n\n    this.leaveRoom = () => {\n      console.log(\"LEAVING ROOM\");\n      this.setState({\n        active: -1\n      });\n    };\n\n    this.state = {\n      retreivedData: false,\n      //probing end of componentDidMount\n      user: \"\",\n      //ip address\n      active: -2,\n      //-2 for no activity; -1 is not in a room, 0 is new room, otherwise room number + 1\n      busy: false,\n      //boolean for whether in Teams meeting or not\n      roomname: \"\",\n      rooms: [],\n      //list of rooms and their IDs, which is their index within the array\n      room_users: [] //entry of ip address and room IDs +1\n\n    };\n    fetch(\"https://api.ipify.org?format=jsonp?callback=?\", {\n      method: \"GET\",\n      headers: {}\n    }).then(res => {\n      return res.text();\n    }).then(ip => {\n      this.setState({\n        user: ip\n      });\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    //before completion of componentDidMount\n    if (this.state.retreivedData === false) {\n      return;\n    } //after completion of componentDidMount\n\n\n    if (this.state.retreivedData === true) {\n      console.log(\"COMPONENT DID UPDATE\");\n\n      if (prevState !== this.state) {\n        this.writeUserData();\n      }\n    }\n  }\n\n  async getUserData() {\n    //retrieve data from firebase\n    console.log(\"RETREIVING DATA\");\n    await firebase.database().ref(\"rooms\").once(\"value\").then(snapshot => {\n      this.gotRooms(snapshot);\n    });\n    await firebase.database().ref(\"roomusers\").once(\"value\").then(snapshot => {\n      this.gotRoomUsers(snapshot);\n    });\n    this.setState({\n      retreivedData: true\n    });\n  }\n\n  gotRooms(data) {\n    console.log(\"GOT ROOMS\");\n    const temp_rooms = data.val();\n    const parsed_rooms = Object.keys(temp_rooms).map(room => {\n      return {\n        id: temp_rooms[room].id\n      };\n    });\n    this.setState({\n      rooms: parsed_rooms\n    });\n  }\n\n  gotRoomUsers(data) {\n    console.log(\"GOT ROOMUSERS\");\n    const temp_roomusers = data.val();\n    const parsed_roomusers = Object.keys(temp_roomusers).map(roomuser => {\n      return {\n        ip: temp_roomusers[roomuser].ip,\n        room: temp_roomusers[roomuser].room\n      };\n    });\n    this.setState({\n      room_users: parsed_roomusers\n    });\n  }\n\n  render() {\n    const rooms = this.state.rooms;\n    const room_users = this.state.room_users;\n    const active = this.state.active;\n\n    if (active === -2) {\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container-fluid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row align-items-center bg-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"display-1 text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }, \"myWorkplace\")), React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"text-center text-light\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, \"myWorkplace is a prototype application intended to facilitate more spontanenous virtual conversations.\"))), React.createElement(\"div\", {\n        className: \"row mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: () => this.authenticateUser(),\n        className: \"btn btn-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, \"Click to enter myWorkplace\"))));\n    }\n\n    if (active === -1) {\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container-fluid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row align-items-center bg-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"display-1 text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, \"myWorkplace\")), React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"text-center text-light\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, \"myWorkplace is a prototype application intended to facilitate more spontanenous virtual conversations.\"))), React.createElement(\"div\", {\n        className: \"row mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, rooms.map(room => React.createElement(\"div\", {\n        className: \"col-sm-4 d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        key: room.id + 1,\n        style: {\n          width: \"18rem\",\n          marginRight: \"1rem\",\n          textAlign: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"card-body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, React.createElement(\"h5\", {\n        className: \"card-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }, room.id + 1), React.createElement(\"p\", {\n        className: \"card-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, \"List users here\"), React.createElement(\"button\", {\n        onClick: () => this.enterRoom(room),\n        className: \"btn btn-link\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, \"Enter room\")))))), React.createElement(\"div\", {\n        className: \"row mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: () => this.constructRoom(),\n        className: \"btn btn-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }, \"Create New Room\"))));\n    }\n\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"container-fluid\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row align-items-center bg-primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-xl-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      className: \"display-1 text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255\n      },\n      __self: this\n    }, \"myWorkplace\")), React.createElement(\"div\", {\n      className: \"col-xl-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"text-center text-light\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258\n      },\n      __self: this\n    }, \"myWorkplace is a prototype application intended to facilitate more spontanenous virtual conversations.\"))), React.createElement(\"div\", {\n      className: \"row mt-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"row d-flex justify-content-around\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 267\n      },\n      __self: this\n    }, \"In room \", active), React.createElement(\"div\", {\n      className: \"row mt-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271\n      },\n      __self: this\n    }), React.createElement(VideoChatContainer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"row mt-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"row d-flex justify-content-around\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: () => this.leaveRoom(),\n      className: \"btn btn-primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278\n      },\n      __self: this\n    }, \"Leave room \", active)))); //return (\n    //  <div className=\"app\">\n    //    <h1>React Video Chat App</h1>\n    //    <h2>WebRTC + Firebase</h2>\n    //    <VideoChatContainer />\n    //  </div>\n    //);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/rushipat/Documents/Data/Programs/videochatapp/src/App.js"],"names":["React","Component","VideoChatContainer","firebase","config","App","constructor","props","componentDidMount","console","log","initializeApp","getUserData","writeUserData","database","ref","set","state","rooms","room_users","errData","err","nameNewRoom","setState","active","enterRoom","room","id","authenticateUser","constructRoom","temp_rooms","push","length","leaveRoom","retreivedData","user","busy","roomname","fetch","method","headers","then","res","text","ip","componentDidUpdate","prevProps","prevState","once","snapshot","gotRooms","gotRoomUsers","data","val","parsed_rooms","Object","keys","map","temp_roomusers","parsed_roomusers","roomuser","render","width","marginRight","textAlign"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./App.css\";\nimport VideoChatContainer from \"./VideoChatContainer\";\nimport firebase from \"firebase/app\";\nimport config from \"./config\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      retreivedData: false, //probing end of componentDidMount\n      user: \"\", //ip address\n      active: -2, //-2 for no activity; -1 is not in a room, 0 is new room, otherwise room number + 1\n      busy: false, //boolean for whether in Teams meeting or not\n      roomname: \"\",\n\n      rooms: [], //list of rooms and their IDs, which is their index within the array\n      room_users: [], //entry of ip address and room IDs +1\n    };\n\n    fetch(\"https://api.ipify.org?format=jsonp?callback=?\", {\n      method: \"GET\",\n      headers: {},\n    })\n      .then((res) => {\n        return res.text();\n      })\n      .then((ip) => {\n        this.setState({ user: ip });\n      });\n  }\n\n  componentDidMount = async () => {\n    //component mounts, only after the first render on the client side\n    console.log(\"COMPONENT DID MOUNT\");\n\n    firebase.initializeApp(config);\n\n    //this.writeUserData();\n\n    await this.getUserData();\n  };\n\n  componentDidUpdate(prevProps, prevState) {\n    //before completion of componentDidMount\n    if (this.state.retreivedData === false) {\n      return;\n    }\n\n    //after completion of componentDidMount\n    if (this.state.retreivedData === true) {\n      console.log(\"COMPONENT DID UPDATE\");\n      if (prevState !== this.state) {\n        this.writeUserData();\n      }\n    }\n  }\n\n  writeUserData = () => {\n    //save the state\n    console.log(\"SAVING DATA\");\n\n    firebase.database().ref(\"/rooms\").set(this.state.rooms);\n    firebase.database().ref(\"/roomusers\").set(this.state.room_users);\n  };\n\n  async getUserData() {\n    //retrieve data from firebase\n    console.log(\"RETREIVING DATA\");\n\n    await firebase\n      .database()\n      .ref(\"rooms\")\n      .once(\"value\")\n      .then((snapshot) => {\n        this.gotRooms(snapshot);\n      });\n\n    await firebase\n      .database()\n      .ref(\"roomusers\")\n      .once(\"value\")\n      .then((snapshot) => {\n        this.gotRoomUsers(snapshot);\n      });\n\n    this.setState({ retreivedData: true });\n  }\n\n  gotRooms(data) {\n    console.log(\"GOT ROOMS\");\n\n    const temp_rooms = data.val();\n    const parsed_rooms = Object.keys(temp_rooms).map((room) => {\n      return { id: temp_rooms[room].id };\n    });\n\n    this.setState({ rooms: parsed_rooms });\n  }\n\n  gotRoomUsers(data) {\n    console.log(\"GOT ROOMUSERS\");\n\n    const temp_roomusers = data.val();\n    const parsed_roomusers = Object.keys(temp_roomusers).map((roomuser) => {\n      return {\n        ip: temp_roomusers[roomuser].ip,\n        room: temp_roomusers[roomuser].room,\n      };\n    });\n\n    this.setState({ room_users: parsed_roomusers });\n  }\n\n  errData = (err) => {\n    console.log(\"GOT AN ERROR\");\n\n    console.log(err);\n  };\n\n  nameNewRoom = () => {\n    console.log(\"NAMING NEW ROOM\");\n    this.setState({ active: 0 });\n  };\n\n  enterRoom = (room) => {\n    console.log(\"ENTERING ROOM\" + room.id);\n    this.setState({ active: room.id + 1 });\n  };\n\n  authenticateUser = () => {\n    console.log(\"AUTHENTICATING USER\");\n    this.setState({ active: -1 });\n  };\n\n  constructRoom = () => {\n    console.log(\"CREATING ROOM\");\n\n    const temp_rooms = this.state.rooms;\n\n    temp_rooms.push({ id: temp_rooms.length });\n    this.setState({ rooms: temp_rooms });\n\n    //this.setState({ active: temp_rooms.length });\n\n    this.enterRoom(temp_rooms[temp_rooms.length]);\n  };\n\n  leaveRoom = () => {\n    console.log(\"LEAVING ROOM\");\n    this.setState({ active: -1 });\n  };\n\n  render() {\n    const { rooms } = this.state;\n    const { room_users } = this.state;\n    const { active } = this.state;\n\n    if (active === -2) {\n      return (\n        <React.Fragment>\n          <div className=\"container-fluid\">\n            <div className=\"row align-items-center bg-primary\">\n              <div className=\"col-xl-12\">\n                <h1 className=\"display-1 text-center\">myWorkplace</h1>\n              </div>\n              <div className=\"col-xl-12\">\n                <p className=\"text-center text-light\">\n                  myWorkplace is a prototype application intended to facilitate\n                  more spontanenous virtual conversations.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"row mt-5\"></div>\n\n            <div className=\"row d-flex justify-content-around\">\n              <button\n                onClick={() => this.authenticateUser()}\n                className=\"btn btn-primary\"\n              >\n                Click to enter myWorkplace\n              </button>\n            </div>\n          </div>\n        </React.Fragment>\n      );\n    }\n\n    if (active === -1) {\n      return (\n        <React.Fragment>\n          <div className=\"container-fluid\">\n            <div className=\"row align-items-center bg-primary\">\n              <div className=\"col-xl-12\">\n                <h1 className=\"display-1 text-center\">myWorkplace</h1>\n              </div>\n              <div className=\"col-xl-12\">\n                <p className=\"text-center text-light\">\n                  myWorkplace is a prototype application intended to facilitate\n                  more spontanenous virtual conversations.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"row mt-5\"></div>\n\n            <div className=\"row d-flex justify-content-around\">\n              {rooms.map((room) => (\n                <div className=\"col-sm-4 d-flex justify-content-around\">\n                  <div\n                    key={room.id + 1}\n                    style={{\n                      width: \"18rem\",\n                      marginRight: \"1rem\",\n                      textAlign: \"center\",\n                    }}\n                  >\n                    <div className=\"card-body\">\n                      <h5 className=\"card-title\">{room.id + 1}</h5>\n                      <p className=\"card-text\">List users here</p>\n                      <button\n                        onClick={() => this.enterRoom(room)}\n                        className=\"btn btn-link\"\n                      >\n                        Enter room\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            <div className=\"row mt-5\"></div>\n\n            <div className=\"row d-flex justify-content-around\">\n              <button\n                onClick={() => this.constructRoom()}\n                className=\"btn btn-primary\"\n              >\n                Create New Room\n              </button>\n            </div>\n          </div>\n        </React.Fragment>\n      );\n    }\n\n    return (\n      <React.Fragment>\n        <div className=\"container-fluid\">\n          <div className=\"row align-items-center bg-primary\">\n            <div className=\"col-xl-12\">\n              <h1 className=\"display-1 text-center\">myWorkplace</h1>\n            </div>\n            <div className=\"col-xl-12\">\n              <p className=\"text-center text-light\">\n                myWorkplace is a prototype application intended to facilitate\n                more spontanenous virtual conversations.\n              </p>\n            </div>\n          </div>\n\n          <div className=\"row mt-5\"></div>\n\n          <div className=\"row d-flex justify-content-around\">\n            In room {active}\n          </div>\n\n          <div className=\"row mt-5\"></div>\n\n          <VideoChatContainer />\n\n          <div className=\"row mt-5\"></div>\n\n          <div className=\"row d-flex justify-content-around\">\n            <button\n              onClick={() => this.leaveRoom()}\n              className=\"btn btn-primary\"\n            >\n              Leave room {active}\n            </button>\n          </div>\n        </div>\n      </React.Fragment>\n    );\n\n    //return (\n    //  <div className=\"app\">\n    //    <h1>React Video Chat App</h1>\n    //    <h2>WebRTC + Firebase</h2>\n    //    <VideoChatContainer />\n    //  </div>\n    //);\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}