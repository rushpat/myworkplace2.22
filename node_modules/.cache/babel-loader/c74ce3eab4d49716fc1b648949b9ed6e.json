{"ast":null,"code":"var _jsxFileName = \"/Users/rushipat/Documents/Data/Programs/videochatapp/src/App.js\";\nimport React, { Component } from \"react\";\nimport \"./App.css\";\nimport VideoChatContainer from \"./VideoChatContainer\";\nimport firebase from \"firebase/app\";\nimport config from \"./config\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = async () => {\n      //component mounts, only after the first render on the client side\n      console.log(\"COMPONENT DID MOUNT\");\n      firebase.initializeApp(config); //this.writeUserData();\n\n      await this.getUserData();\n    };\n\n    this.writeUserData = () => {\n      //save the state\n      console.log(\"SAVING DATA\");\n      firebase.database().ref(\"/rooms\").set(this.state.rooms);\n      firebase.database().ref(\"/roomusers\").set(this.state.room_users);\n    };\n\n    this.errData = err => {\n      console.log(\"GOT AN ERROR\");\n      console.log(err);\n    };\n\n    this.nameNewRoom = () => {\n      console.log(\"NAMING NEW ROOM\");\n      this.setState({\n        active: 0\n      });\n    };\n\n    this.enterRoom = room => {\n      console.log(\"ENTERING ROOM\" + room.id);\n      this.setState({\n        active: room.id + 1\n      });\n    };\n\n    this.authenticateUser = () => {\n      console.log(\"AUTHENTICATING USER\");\n      this.setState({\n        active: -1\n      });\n    };\n\n    this.constructRoom = () => {\n      console.log(\"CREATING ROOM\");\n      console.log(this.state.roomname);\n      const temp_rooms = this.state.rooms;\n      const temp_roomname = this.state.roomname;\n      this.setState({\n        roomname: \"\"\n      });\n      temp_rooms.push({\n        id: \"2\",\n        name: temp_roomname\n      });\n      this.setState({\n        rooms: temp_rooms\n      }); //this.writeUserData();\n      //this.setState({ active: 1 });\n    };\n\n    this.leaveRoom = () => {\n      console.log(\"LEAVING ROOM\");\n      this.setState({\n        active: -1\n      });\n    };\n\n    this.handleInputChange = e => {\n      console.log(\"in handle change\");\n      const a = e.target.value;\n      console.log(a);\n      this.setState({\n        roomname: a\n      });\n      console.log(this.state.roomname);\n    };\n\n    this.state = {\n      retreivedData: false,\n      //probing end of componentDidMount\n      user: \"\",\n      //ip address\n      active: -2,\n      //-2 for no activity; -1 is not in a room, 0 is new room, otherwise room number + 1\n      busy: false,\n      //boolean for whether in Teams meeting or not\n      roomname: \"\",\n      rooms: [],\n      //list of rooms and their IDs, which is their index within the array\n      room_users: [] //entry of ip address and room IDs +1\n\n    };\n    fetch(\"https://api.ipify.org?format=jsonp?callback=?\", {\n      method: \"GET\",\n      headers: {}\n    }).then(res => {\n      return res.text();\n    }).then(ip => {\n      this.setState({\n        user: ip\n      });\n    });\n    this.delta = this.handleInputChange.bind(this);\n    this.delta = this.constructRoom.bind(this);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    //before completion of componentDidMount\n    if (this.state.retreivedData === false) {\n      return;\n    } //after completion of componentDidMount\n\n\n    if (this.state.retreivedData === true) {\n      console.log(\"COMPONENT DID UPDATE\");\n\n      if (prevState !== this.state) {\n        this.writeUserData();\n      }\n    }\n  }\n\n  async getUserData() {\n    //retrieve data from firebase\n    console.log(\"RETREIVING DATA\");\n    await firebase.database().ref(\"rooms\").once(\"value\").then(snapshot => {\n      this.gotRooms(snapshot);\n    });\n    await firebase.database().ref(\"roomusers\").once(\"value\").then(snapshot => {\n      this.gotRoomUsers(snapshot);\n    });\n    this.setState({\n      retreivedData: true\n    });\n  }\n\n  gotRooms(data) {\n    console.log(\"GOT ROOMS\");\n    const temp_rooms = data.val();\n    const parsed_rooms = Object.keys(temp_rooms).map(room => {\n      return {\n        id: temp_rooms[room].id\n      };\n    });\n    this.setState({\n      rooms: parsed_rooms\n    });\n  }\n\n  gotRoomUsers(data) {\n    console.log(\"GOT ROOMUSERS\");\n    const temp_roomusers = data.val();\n    const parsed_roomusers = Object.keys(temp_roomusers).map(roomuser => {\n      return {\n        ip: temp_roomusers[roomuser].ip,\n        room: temp_roomusers[roomuser].room\n      };\n    });\n    this.setState({\n      room_users: parsed_roomusers\n    });\n  }\n\n  render() {\n    const rooms = this.state.rooms;\n    const room_users = this.state.room_users;\n    const active = this.state.active;\n\n    if (active === -2) {\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container-fluid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row align-items-center bg-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"display-1 text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, \"myWorkplace\")), React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"text-center text-light\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, \"myWorkplace is a prototype application intended to facilitate more spontanenous virtual conversations.\"))), React.createElement(\"div\", {\n        className: \"row mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: () => this.authenticateUser(),\n        className: \"btn btn-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, \"Click to enter myWorkplace\"))));\n    }\n\n    if (active === -1) {\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container-fluid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row align-items-center bg-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"display-1 text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, \"myWorkplace\")), React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"text-center text-light\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, \"myWorkplace is a prototype application intended to facilitate more spontanenous virtual conversations.\"))), React.createElement(\"div\", {\n        className: \"row mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, rooms.map(room => React.createElement(\"div\", {\n        className: \"col-sm-4 d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        key: room.id,\n        style: {\n          width: \"18rem\",\n          marginRight: \"1rem\",\n          textAlign: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"card-body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, React.createElement(\"h5\", {\n        className: \"card-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }, room.id), React.createElement(\"p\", {\n        className: \"card-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237\n        },\n        __self: this\n      }, \"List users here\"), React.createElement(\"button\", {\n        onClick: () => this.enterRoom(room),\n        className: \"btn btn-link\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }, \"Enter room\")))))), React.createElement(\"div\", {\n        className: \"row mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: () => this.nameNewRoom(),\n        className: \"btn btn-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      }, \"Create New Room\"))));\n    }\n\n    if (active === 0) {\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container-fluid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row align-items-center bg-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"display-1 text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271\n        },\n        __self: this\n      }, \"myWorkplace\")), React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"text-center text-light\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274\n        },\n        __self: this\n      }, \"myWorkplace is a prototype application intended to facilitate more spontanenous virtual conversations.\"))), React.createElement(\"div\", {\n        className: \"row mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control col-md-3\",\n        placeholder: \"Enter a name for your new room\",\n        value: this.state.roomname,\n        onChange: this.handleInputChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"row mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 293\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: () => this.constructRoom(),\n        className: \"btn btn-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296\n        },\n        __self: this\n      }, \"Create room\"))));\n    }\n\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"container-fluid\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row align-items-center bg-primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-xl-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      className: \"display-1 text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313\n      },\n      __self: this\n    }, \"myWorkplace\")), React.createElement(\"div\", {\n      className: \"col-xl-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"text-center text-light\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316\n      },\n      __self: this\n    }, \"myWorkplace is a prototype application intended to facilitate more spontanenous virtual conversations.\"))), React.createElement(\"div\", {\n      className: \"row mt-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"row d-flex justify-content-around\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 325\n      },\n      __self: this\n    }, \"In room\"), React.createElement(\"div\", {\n      className: \"row mt-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327\n      },\n      __self: this\n    }), React.createElement(VideoChatContainer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 329\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"row mt-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 331\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"row d-flex justify-content-around\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: () => this.leaveRoom(),\n      className: \"btn btn-primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 334\n      },\n      __self: this\n    }, \"Leave room \", active)))); //return (\n    //  <div className=\"app\">\n    //    <h1>React Video Chat App</h1>\n    //    <h2>WebRTC + Firebase</h2>\n    //    <VideoChatContainer />\n    //  </div>\n    //);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/rushipat/Documents/Data/Programs/videochatapp/src/App.js"],"names":["React","Component","VideoChatContainer","firebase","config","App","constructor","props","componentDidMount","console","log","initializeApp","getUserData","writeUserData","database","ref","set","state","rooms","room_users","errData","err","nameNewRoom","setState","active","enterRoom","room","id","authenticateUser","constructRoom","roomname","temp_rooms","temp_roomname","push","name","leaveRoom","handleInputChange","e","a","target","value","retreivedData","user","busy","fetch","method","headers","then","res","text","ip","delta","bind","componentDidUpdate","prevProps","prevState","once","snapshot","gotRooms","gotRoomUsers","data","val","parsed_rooms","Object","keys","map","temp_roomusers","parsed_roomusers","roomuser","render","width","marginRight","textAlign"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./App.css\";\nimport VideoChatContainer from \"./VideoChatContainer\";\nimport firebase from \"firebase/app\";\nimport config from \"./config\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      retreivedData: false, //probing end of componentDidMount\n      user: \"\", //ip address\n      active: -2, //-2 for no activity; -1 is not in a room, 0 is new room, otherwise room number + 1\n      busy: false, //boolean for whether in Teams meeting or not\n      roomname: \"\",\n\n      rooms: [], //list of rooms and their IDs, which is their index within the array\n      room_users: [], //entry of ip address and room IDs +1\n    };\n\n    fetch(\"https://api.ipify.org?format=jsonp?callback=?\", {\n      method: \"GET\",\n      headers: {},\n    })\n      .then((res) => {\n        return res.text();\n      })\n      .then((ip) => {\n        this.setState({ user: ip });\n      });\n\n    this.delta = this.handleInputChange.bind(this);\n    this.delta = this.constructRoom.bind(this);\n  }\n\n  componentDidMount = async () => {\n    //component mounts, only after the first render on the client side\n    console.log(\"COMPONENT DID MOUNT\");\n\n    firebase.initializeApp(config);\n\n    //this.writeUserData();\n\n    await this.getUserData();\n  };\n\n  componentDidUpdate(prevProps, prevState) {\n    //before completion of componentDidMount\n    if (this.state.retreivedData === false) {\n      return;\n    }\n\n    //after completion of componentDidMount\n    if (this.state.retreivedData === true) {\n      console.log(\"COMPONENT DID UPDATE\");\n      if (prevState !== this.state) {\n        this.writeUserData();\n      }\n    }\n  }\n\n  writeUserData = () => {\n    //save the state\n    console.log(\"SAVING DATA\");\n\n    firebase.database().ref(\"/rooms\").set(this.state.rooms);\n    firebase.database().ref(\"/roomusers\").set(this.state.room_users);\n  };\n\n  async getUserData() {\n    //retrieve data from firebase\n    console.log(\"RETREIVING DATA\");\n\n    await firebase\n      .database()\n      .ref(\"rooms\")\n      .once(\"value\")\n      .then((snapshot) => {\n        this.gotRooms(snapshot);\n      });\n\n    await firebase\n      .database()\n      .ref(\"roomusers\")\n      .once(\"value\")\n      .then((snapshot) => {\n        this.gotRoomUsers(snapshot);\n      });\n\n    this.setState({ retreivedData: true });\n  }\n\n  gotRooms(data) {\n    console.log(\"GOT ROOMS\");\n\n    const temp_rooms = data.val();\n    const parsed_rooms = Object.keys(temp_rooms).map((room) => {\n      return { id: temp_rooms[room].id };\n    });\n\n    this.setState({ rooms: parsed_rooms });\n  }\n\n  gotRoomUsers(data) {\n    console.log(\"GOT ROOMUSERS\");\n\n    const temp_roomusers = data.val();\n    const parsed_roomusers = Object.keys(temp_roomusers).map((roomuser) => {\n      return {\n        ip: temp_roomusers[roomuser].ip,\n        room: temp_roomusers[roomuser].room,\n      };\n    });\n\n    this.setState({ room_users: parsed_roomusers });\n  }\n\n  errData = (err) => {\n    console.log(\"GOT AN ERROR\");\n\n    console.log(err);\n  };\n\n  nameNewRoom = () => {\n    console.log(\"NAMING NEW ROOM\");\n    this.setState({ active: 0 });\n  };\n\n  enterRoom = (room) => {\n    console.log(\"ENTERING ROOM\" + room.id);\n    this.setState({ active: room.id + 1 });\n  };\n\n  authenticateUser = () => {\n    console.log(\"AUTHENTICATING USER\");\n    this.setState({ active: -1 });\n  };\n\n  constructRoom = () => {\n    console.log(\"CREATING ROOM\");\n    console.log(this.state.roomname);\n\n    const temp_rooms = this.state.rooms;\n    const temp_roomname = this.state.roomname;\n\n    this.setState({ roomname: \"\" });\n    temp_rooms.push({ id: \"2\", name: temp_roomname });\n    this.setState({ rooms: temp_rooms });\n\n    //this.writeUserData();\n    //this.setState({ active: 1 });\n  };\n\n  leaveRoom = () => {\n    console.log(\"LEAVING ROOM\");\n    this.setState({ active: -1 });\n  };\n\n  handleInputChange = (e) => {\n    console.log(\"in handle change\");\n    const a = e.target.value;\n    console.log(a);\n    this.setState({\n      roomname: a,\n    });\n    console.log(this.state.roomname);\n  };\n\n  render() {\n    const { rooms } = this.state;\n    const { room_users } = this.state;\n    const { active } = this.state;\n\n    if (active === -2) {\n      return (\n        <React.Fragment>\n          <div className=\"container-fluid\">\n            <div className=\"row align-items-center bg-primary\">\n              <div className=\"col-xl-12\">\n                <h1 className=\"display-1 text-center\">myWorkplace</h1>\n              </div>\n              <div className=\"col-xl-12\">\n                <p className=\"text-center text-light\">\n                  myWorkplace is a prototype application intended to facilitate\n                  more spontanenous virtual conversations.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"row mt-5\"></div>\n\n            <div className=\"row d-flex justify-content-around\">\n              <button\n                onClick={() => this.authenticateUser()}\n                className=\"btn btn-primary\"\n              >\n                Click to enter myWorkplace\n              </button>\n            </div>\n          </div>\n        </React.Fragment>\n      );\n    }\n\n    if (active === -1) {\n      return (\n        <React.Fragment>\n          <div className=\"container-fluid\">\n            <div className=\"row align-items-center bg-primary\">\n              <div className=\"col-xl-12\">\n                <h1 className=\"display-1 text-center\">myWorkplace</h1>\n              </div>\n              <div className=\"col-xl-12\">\n                <p className=\"text-center text-light\">\n                  myWorkplace is a prototype application intended to facilitate\n                  more spontanenous virtual conversations.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"row mt-5\"></div>\n\n            <div className=\"row d-flex justify-content-around\">\n              {rooms.map((room) => (\n                <div className=\"col-sm-4 d-flex justify-content-around\">\n                  <div\n                    key={room.id}\n                    style={{\n                      width: \"18rem\",\n                      marginRight: \"1rem\",\n                      textAlign: \"center\",\n                    }}\n                  >\n                    <div className=\"card-body\">\n                      <h5 className=\"card-title\">{room.id}</h5>\n                      <p className=\"card-text\">List users here</p>\n                      <button\n                        onClick={() => this.enterRoom(room)}\n                        className=\"btn btn-link\"\n                      >\n                        Enter room\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            <div className=\"row mt-5\"></div>\n\n            <div className=\"row d-flex justify-content-around\">\n              <button\n                onClick={() => this.nameNewRoom()}\n                className=\"btn btn-primary\"\n              >\n                Create New Room\n              </button>\n            </div>\n          </div>\n        </React.Fragment>\n      );\n    }\n\n    if (active === 0) {\n      return (\n        <React.Fragment>\n          <div className=\"container-fluid\">\n            <div className=\"row align-items-center bg-primary\">\n              <div className=\"col-xl-12\">\n                <h1 className=\"display-1 text-center\">myWorkplace</h1>\n              </div>\n              <div className=\"col-xl-12\">\n                <p className=\"text-center text-light\">\n                  myWorkplace is a prototype application intended to facilitate\n                  more spontanenous virtual conversations.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"row mt-5\"></div>\n\n            <div className=\"row d-flex justify-content-around\">\n              <input\n                type=\"text\"\n                className=\"form-control col-md-3\"\n                placeholder=\"Enter a name for your new room\"\n                value={this.state.roomname}\n                onChange={this.handleInputChange}\n              />\n            </div>\n\n            <div className=\"row mt-5\"></div>\n\n            <div className=\"row d-flex justify-content-around\">\n              <button\n                onClick={() => this.constructRoom()}\n                className=\"btn btn-primary\"\n              >\n                Create room\n              </button>\n            </div>\n          </div>\n        </React.Fragment>\n      );\n    }\n\n    return (\n      <React.Fragment>\n        <div className=\"container-fluid\">\n          <div className=\"row align-items-center bg-primary\">\n            <div className=\"col-xl-12\">\n              <h1 className=\"display-1 text-center\">myWorkplace</h1>\n            </div>\n            <div className=\"col-xl-12\">\n              <p className=\"text-center text-light\">\n                myWorkplace is a prototype application intended to facilitate\n                more spontanenous virtual conversations.\n              </p>\n            </div>\n          </div>\n\n          <div className=\"row mt-5\"></div>\n\n          <div className=\"row d-flex justify-content-around\">In room</div>\n\n          <div className=\"row mt-5\"></div>\n\n          <VideoChatContainer />\n\n          <div className=\"row mt-5\"></div>\n\n          <div className=\"row d-flex justify-content-around\">\n            <button\n              onClick={() => this.leaveRoom()}\n              className=\"btn btn-primary\"\n            >\n              Leave room {active}\n            </button>\n          </div>\n        </div>\n      </React.Fragment>\n    );\n\n    //return (\n    //  <div className=\"app\">\n    //    <h1>React Video Chat App</h1>\n    //    <h2>WebRTC + Firebase</h2>\n    //    <VideoChatContainer />\n    //  </div>\n    //);\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}