{"ast":null,"code":"var _jsxFileName = \"/Users/rushipat/Documents/Data/Programs/videochatapp/src/App.js\";\nimport React, { Component } from \"react\";\nimport \"./App.css\";\nimport VideoChatContainer from \"./VideoChatContainer\";\nimport firebase from \"firebase/app\";\nimport config from \"./config\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = async () => {\n      //component mounts, only after the first render on the client side\n      console.log(\"COMPONENT DID MOUNT\");\n      firebase.initializeApp(config); //this.writeUserData();\n\n      await this.getUserData();\n    };\n\n    this.writeUserData = () => {\n      //save the state\n      console.log(\"SAVING DATA\");\n      firebase.database().ref(\"/rooms\").set(this.state.rooms);\n      firebase.database().ref(\"/roomusers\").set(this.state.room_users);\n    };\n\n    this.errData = err => {\n      console.log(\"GOT AN ERROR\");\n      console.log(err);\n    };\n\n    this.nameNewRoom = () => {\n      console.log(\"NAMING NEW ROOM\");\n      this.setState({\n        active: 0\n      });\n    };\n\n    this.enterRoom = room => {\n      console.log(\"ENTERING ROOM\" + room.id);\n      this.setState({\n        active: room.id + 1\n      });\n    };\n\n    this.authenticateUser = () => {\n      console.log(\"AUTHENTICATING USER\");\n      this.setState({\n        active: -1\n      });\n    };\n\n    this.constructRoom = () => {\n      console.log(\"CREATING ROOM\");\n      temp_rooms = this.state.rooms;\n      temp_roomname = this.state.roomname;\n      temp_rooms.push({\n        id: \"2\",\n        name: temp_roomname\n      });\n      this.setState({\n        rooms: temp_rooms\n      });\n      this.writeUserData();\n      this.setState({\n        active: 1\n      });\n    };\n\n    this.leaveRoom = () => {\n      console.log(\"LEAVING ROOM\");\n      this.setState({\n        active: -1\n      });\n    };\n\n    this.state = {\n      retreivedData: false,\n      //probing end of componentDidMount\n      user: \"\",\n      //ip address\n      active: -2,\n      //-2 for no activity; -1 is not in a room, 0 is new room, otherwise room number + 1\n      busy: false,\n      //boolean for whether in Teams meeting or not\n      roomname: \"\",\n      rooms: [],\n      //list of rooms and their IDs, which is their index within the array\n      room_users: [] //entry of ip address and room IDs +1\n\n    };\n    fetch(\"https://api.ipify.org?format=jsonp?callback=?\", {\n      method: \"GET\",\n      headers: {}\n    }).then(res => {\n      return res.text();\n    }).then(ip => {\n      this.setState({\n        user: ip\n      });\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    //before completion of componentDidMount\n    if (this.state.retreivedData === false) {\n      return;\n    } //after completion of componentDidMount\n\n\n    if (this.state.retreivedData === true) {\n      console.log(\"COMPONENT DID UPDATE\");\n\n      if (prevState !== this.state) {\n        this.writeUserData();\n      }\n    }\n  }\n\n  async getUserData() {\n    //retrieve data from firebase\n    console.log(\"RETREIVING DATA\");\n    await firebase.database().ref(\"rooms\").once(\"value\").then(snapshot => {\n      this.gotRooms(snapshot);\n    });\n    await firebase.database().ref(\"roomusers\").once(\"value\").then(snapshot => {\n      this.gotRoomUsers(snapshot);\n    });\n    this.setState({\n      retreivedData: true\n    });\n  }\n\n  gotRooms(data) {\n    console.log(\"GOT ROOMS\");\n    const temp_rooms = data.val();\n    const parsed_rooms = Object.keys(temp_rooms).map(room => {\n      return {\n        id: temp_rooms[room].id\n      };\n    });\n    this.setState({\n      rooms: parsed_rooms\n    });\n  }\n\n  gotRoomUsers(data) {\n    console.log(\"GOT ROOMUSERS\");\n    const temp_roomusers = data.val();\n    const parsed_roomusers = Object.keys(temp_roomusers).map(roomuser => {\n      return {\n        ip: temp_roomusers[roomuser].ip,\n        room: temp_roomusers[roomuser].room\n      };\n    });\n    this.setState({\n      room_users: parsed_roomusers\n    });\n  }\n\n  handleInputChange(e) {\n    this.setState({\n      roomname: e.target.value\n    });\n  }\n\n  render() {\n    const rooms = this.state.rooms;\n    const room_users = this.state.room_users;\n    const active = this.state.active;\n\n    if (active === -2) {\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container-fluid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row align-items-center bg-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"display-1 text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, \"myWorkplace\")), React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"text-center text-light\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, \"myWorkplace is a prototype application intended to facilitate more spontanenous virtual conversations.\"))), React.createElement(\"div\", {\n        className: \"row mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: () => this.authenticateUser(),\n        className: \"btn btn-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, \"Click to enter myWorkplace\"))));\n    }\n\n    if (active === -1) {\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container-fluid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row align-items-center bg-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"display-1 text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, \"myWorkplace\")), React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"text-center text-light\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }, \"myWorkplace is a prototype application intended to facilitate more spontanenous virtual conversations.\"))), React.createElement(\"div\", {\n        className: \"row mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, rooms.map(room => React.createElement(\"div\", {\n        className: \"col-sm-4 d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        key: room.id,\n        style: {\n          width: \"18rem\",\n          marginRight: \"1rem\",\n          textAlign: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"card-body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, React.createElement(\"h5\", {\n        className: \"card-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, room.id), React.createElement(\"p\", {\n        className: \"card-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }, \"List users here\"), React.createElement(\"button\", {\n        onClick: () => this.enterRoom(room),\n        className: \"btn btn-link\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229\n        },\n        __self: this\n      }, \"Enter room\")))))), React.createElement(\"div\", {\n        className: \"row mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: () => this.nameNewRoom(),\n        className: \"btn btn-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      }, \"Create New Room\"))));\n    }\n\n    if (active === 0) {\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container-fluid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row align-items-center bg-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"display-1 text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }, \"myWorkplace\")), React.createElement(\"div\", {\n        className: \"col-xl-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"text-center text-light\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265\n        },\n        __self: this\n      }, \"myWorkplace is a prototype application intended to facilitate more spontanenous virtual conversations.\"))), React.createElement(\"div\", {\n        className: \"row mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control col-md-3\",\n        placeholder: \"Enter a name for your new room\",\n        onChange: this.handleInputChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"row mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row d-flex justify-content-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: () => this.constructRoom(),\n        className: \"btn btn-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 286\n        },\n        __self: this\n      }, \"Create room\"))));\n    }\n\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"container-fluid\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row align-items-center bg-primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-xl-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      className: \"display-1 text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303\n      },\n      __self: this\n    }, \"myWorkplace\")), React.createElement(\"div\", {\n      className: \"col-xl-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"text-center text-light\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306\n      },\n      __self: this\n    }, \"myWorkplace is a prototype application intended to facilitate more spontanenous virtual conversations.\"))), React.createElement(\"div\", {\n      className: \"row mt-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"row d-flex justify-content-around\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315\n      },\n      __self: this\n    }, \"In room\"), React.createElement(\"div\", {\n      className: \"row mt-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317\n      },\n      __self: this\n    }), React.createElement(VideoChatContainer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"row mt-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"row d-flex justify-content-around\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: () => this.leaveRoom(),\n      className: \"btn btn-primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324\n      },\n      __self: this\n    }, \"Leave room \", active)))); //return (\n    //  <div className=\"app\">\n    //    <h1>React Video Chat App</h1>\n    //    <h2>WebRTC + Firebase</h2>\n    //    <VideoChatContainer />\n    //  </div>\n    //);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/rushipat/Documents/Data/Programs/videochatapp/src/App.js"],"names":["React","Component","VideoChatContainer","firebase","config","App","constructor","props","componentDidMount","console","log","initializeApp","getUserData","writeUserData","database","ref","set","state","rooms","room_users","errData","err","nameNewRoom","setState","active","enterRoom","room","id","authenticateUser","constructRoom","temp_rooms","temp_roomname","roomname","push","name","leaveRoom","retreivedData","user","busy","fetch","method","headers","then","res","text","ip","componentDidUpdate","prevProps","prevState","once","snapshot","gotRooms","gotRoomUsers","data","val","parsed_rooms","Object","keys","map","temp_roomusers","parsed_roomusers","roomuser","handleInputChange","e","target","value","render","width","marginRight","textAlign"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./App.css\";\nimport VideoChatContainer from \"./VideoChatContainer\";\nimport firebase from \"firebase/app\";\nimport config from \"./config\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      retreivedData: false, //probing end of componentDidMount\n      user: \"\", //ip address\n      active: -2, //-2 for no activity; -1 is not in a room, 0 is new room, otherwise room number + 1\n      busy: false, //boolean for whether in Teams meeting or not\n      roomname: \"\",\n\n      rooms: [], //list of rooms and their IDs, which is their index within the array\n      room_users: [], //entry of ip address and room IDs +1\n    };\n\n    fetch(\"https://api.ipify.org?format=jsonp?callback=?\", {\n      method: \"GET\",\n      headers: {},\n    })\n      .then((res) => {\n        return res.text();\n      })\n      .then((ip) => {\n        this.setState({ user: ip });\n      });\n  }\n\n  componentDidMount = async () => {\n    //component mounts, only after the first render on the client side\n    console.log(\"COMPONENT DID MOUNT\");\n\n    firebase.initializeApp(config);\n\n    //this.writeUserData();\n\n    await this.getUserData();\n  };\n\n  componentDidUpdate(prevProps, prevState) {\n    //before completion of componentDidMount\n    if (this.state.retreivedData === false) {\n      return;\n    }\n\n    //after completion of componentDidMount\n    if (this.state.retreivedData === true) {\n      console.log(\"COMPONENT DID UPDATE\");\n      if (prevState !== this.state) {\n        this.writeUserData();\n      }\n    }\n  }\n\n  writeUserData = () => {\n    //save the state\n    console.log(\"SAVING DATA\");\n\n    firebase.database().ref(\"/rooms\").set(this.state.rooms);\n    firebase.database().ref(\"/roomusers\").set(this.state.room_users);\n  };\n\n  async getUserData() {\n    //retrieve data from firebase\n    console.log(\"RETREIVING DATA\");\n\n    await firebase\n      .database()\n      .ref(\"rooms\")\n      .once(\"value\")\n      .then((snapshot) => {\n        this.gotRooms(snapshot);\n      });\n\n    await firebase\n      .database()\n      .ref(\"roomusers\")\n      .once(\"value\")\n      .then((snapshot) => {\n        this.gotRoomUsers(snapshot);\n      });\n\n    this.setState({ retreivedData: true });\n  }\n\n  gotRooms(data) {\n    console.log(\"GOT ROOMS\");\n\n    const temp_rooms = data.val();\n    const parsed_rooms = Object.keys(temp_rooms).map((room) => {\n      return { id: temp_rooms[room].id };\n    });\n\n    this.setState({ rooms: parsed_rooms });\n  }\n\n  gotRoomUsers(data) {\n    console.log(\"GOT ROOMUSERS\");\n\n    const temp_roomusers = data.val();\n    const parsed_roomusers = Object.keys(temp_roomusers).map((roomuser) => {\n      return {\n        ip: temp_roomusers[roomuser].ip,\n        room: temp_roomusers[roomuser].room,\n      };\n    });\n\n    this.setState({ room_users: parsed_roomusers });\n  }\n\n  errData = (err) => {\n    console.log(\"GOT AN ERROR\");\n\n    console.log(err);\n  };\n\n  nameNewRoom = () => {\n    console.log(\"NAMING NEW ROOM\");\n    this.setState({ active: 0 });\n  };\n\n  enterRoom = (room) => {\n    console.log(\"ENTERING ROOM\" + room.id);\n    this.setState({ active: room.id + 1 });\n  };\n\n  authenticateUser = () => {\n    console.log(\"AUTHENTICATING USER\");\n    this.setState({ active: -1 });\n  };\n\n  constructRoom = () => {\n    console.log(\"CREATING ROOM\");\n\n    temp_rooms = this.state.rooms;\n    temp_roomname = this.state.roomname;\n\n    temp_rooms.push({ id: \"2\", name: temp_roomname });\n    this.setState({ rooms: temp_rooms });\n\n    this.writeUserData();\n    this.setState({ active: 1 });\n  };\n\n  leaveRoom = () => {\n    console.log(\"LEAVING ROOM\");\n    this.setState({ active: -1 });\n  };\n\n  handleInputChange(e) {\n    this.setState({\n      roomname: e.target.value,\n    });\n  }\n\n  render() {\n    const { rooms } = this.state;\n    const { room_users } = this.state;\n    const { active } = this.state;\n\n    if (active === -2) {\n      return (\n        <React.Fragment>\n          <div className=\"container-fluid\">\n            <div className=\"row align-items-center bg-primary\">\n              <div className=\"col-xl-12\">\n                <h1 className=\"display-1 text-center\">myWorkplace</h1>\n              </div>\n              <div className=\"col-xl-12\">\n                <p className=\"text-center text-light\">\n                  myWorkplace is a prototype application intended to facilitate\n                  more spontanenous virtual conversations.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"row mt-5\"></div>\n\n            <div className=\"row d-flex justify-content-around\">\n              <button\n                onClick={() => this.authenticateUser()}\n                className=\"btn btn-primary\"\n              >\n                Click to enter myWorkplace\n              </button>\n            </div>\n          </div>\n        </React.Fragment>\n      );\n    }\n\n    if (active === -1) {\n      return (\n        <React.Fragment>\n          <div className=\"container-fluid\">\n            <div className=\"row align-items-center bg-primary\">\n              <div className=\"col-xl-12\">\n                <h1 className=\"display-1 text-center\">myWorkplace</h1>\n              </div>\n              <div className=\"col-xl-12\">\n                <p className=\"text-center text-light\">\n                  myWorkplace is a prototype application intended to facilitate\n                  more spontanenous virtual conversations.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"row mt-5\"></div>\n\n            <div className=\"row d-flex justify-content-around\">\n              {rooms.map((room) => (\n                <div className=\"col-sm-4 d-flex justify-content-around\">\n                  <div\n                    key={room.id}\n                    style={{\n                      width: \"18rem\",\n                      marginRight: \"1rem\",\n                      textAlign: \"center\",\n                    }}\n                  >\n                    <div className=\"card-body\">\n                      <h5 className=\"card-title\">{room.id}</h5>\n                      <p className=\"card-text\">List users here</p>\n                      <button\n                        onClick={() => this.enterRoom(room)}\n                        className=\"btn btn-link\"\n                      >\n                        Enter room\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            <div className=\"row mt-5\"></div>\n\n            <div className=\"row d-flex justify-content-around\">\n              <button\n                onClick={() => this.nameNewRoom()}\n                className=\"btn btn-primary\"\n              >\n                Create New Room\n              </button>\n            </div>\n          </div>\n        </React.Fragment>\n      );\n    }\n\n    if (active === 0) {\n      return (\n        <React.Fragment>\n          <div className=\"container-fluid\">\n            <div className=\"row align-items-center bg-primary\">\n              <div className=\"col-xl-12\">\n                <h1 className=\"display-1 text-center\">myWorkplace</h1>\n              </div>\n              <div className=\"col-xl-12\">\n                <p className=\"text-center text-light\">\n                  myWorkplace is a prototype application intended to facilitate\n                  more spontanenous virtual conversations.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"row mt-5\"></div>\n\n            <div className=\"row d-flex justify-content-around\">\n              <input\n                type=\"text\"\n                className=\"form-control col-md-3\"\n                placeholder=\"Enter a name for your new room\"\n                onChange={this.handleInputChange}\n              />\n            </div>\n\n            <div className=\"row mt-5\"></div>\n\n            <div className=\"row d-flex justify-content-around\">\n              <button\n                onClick={() => this.constructRoom()}\n                className=\"btn btn-primary\"\n              >\n                Create room\n              </button>\n            </div>\n          </div>\n        </React.Fragment>\n      );\n    }\n\n    return (\n      <React.Fragment>\n        <div className=\"container-fluid\">\n          <div className=\"row align-items-center bg-primary\">\n            <div className=\"col-xl-12\">\n              <h1 className=\"display-1 text-center\">myWorkplace</h1>\n            </div>\n            <div className=\"col-xl-12\">\n              <p className=\"text-center text-light\">\n                myWorkplace is a prototype application intended to facilitate\n                more spontanenous virtual conversations.\n              </p>\n            </div>\n          </div>\n\n          <div className=\"row mt-5\"></div>\n\n          <div className=\"row d-flex justify-content-around\">In room</div>\n\n          <div className=\"row mt-5\"></div>\n\n          <VideoChatContainer />\n\n          <div className=\"row mt-5\"></div>\n\n          <div className=\"row d-flex justify-content-around\">\n            <button\n              onClick={() => this.leaveRoom()}\n              className=\"btn btn-primary\"\n            >\n              Leave room {active}\n            </button>\n          </div>\n        </div>\n      </React.Fragment>\n    );\n\n    //return (\n    //  <div className=\"app\">\n    //    <h1>React Video Chat App</h1>\n    //    <h2>WebRTC + Firebase</h2>\n    //    <VideoChatContainer />\n    //  </div>\n    //);\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}